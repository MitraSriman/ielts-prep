<!DOCTYPE html><html lang="en">
<head>
<meta charset="UTF-8">
<title>IELTS CBT Practice Test</title>
<style>
body{font-family:Arial,Helvetica,sans-serif;margin:0;background:#f5f7fa}
header{background:#0a3d62;color:#fff;padding:15px;text-align:center}
.container{display:flex;height:calc(100vh - 60px)}
.left{width:60%;padding:20px;overflow-y:auto;background:#ffffff}
.right{width:40%;padding:20px;overflow-y:auto;border-left:1px solid #ddd;background:#fafafa}
.question{margin-bottom:15px}
.timer{font-weight:bold;color:#c0392b}
button{padding:8px 12px;margin:5px 0}
input, select{width:90%;padding:5px;margin-top:5px}
</style>
</head>
<body>
<header>
<h2>IELTS Academic – CBT Practice Test</h2>
<p class="timer" id="timer">Time: 60:00</p>
</header><div class="container">
<div class="left" id="passageArea"></div>
<div class="right" id="questionArea"></div>
</div><footer style="text-align:center;padding:10px">
<button onclick="loadReading()">Reading Test</button>
<button onclick="loadListening()">Listening Test</button>
<button onclick="submitTest()">Submit Test</button>
<button onclick="showHistory()">View Result History</button>
</footer><script>
// ===== TIMER =====
let time=3600; let timerInterval;
function startTimer(){
  clearInterval(timerInterval);
  timerInterval=setInterval(()=>{
    let m=Math.floor(time/60),s=time%60;
    document.getElementById('timer').innerText=`Time: ${m}:${s<10?'0':''}${s}`;
    if(time>0) time--;
  },1000);
}

// ===== READING SECTION =====
const readingPassages=[
  {title:"Passage 1: Urban Farming", text:`Urban farming has become popular worldwide. Rooftop gardens and community plots reduce transportation costs. Supporters highlight mental health and community benefits, but critics mention limited space and high costs.`},
  {title:"Passage 2: Sleep and Health", text:`Sleep is critical for memory and recovery. Adults need 7-9 hours per night. Sleep deprivation affects focus, immunity, and long-term health. Screen usage can disrupt sleep patterns.`},
  {title:"Passage 3: The History of Paper", text:`Paper was invented in China over 2000 years ago. It spread globally and transformed education and record keeping. Digital media is dominant, but paper remains widely used for accessibility and affordability.`}
];

const readingQuestions=[
  {passage:0,type:"TFNG",question:"Urban farming reduces carbon emissions?",answer:"true"},
  {passage:0,type:"TFNG",question:"Rooftop gardens are built in rural areas?",answer:"false"},
  {passage:0,type:"MC",question:"Which is NOT a benefit of urban farming?",options:["Mental health","Community ties","Space constraints"],answer:"Space constraints"},
  {passage:1,type:"SC",question:"Adults need ___ hours of sleep per night.",answer:"7-9"},
  {passage:1,type:"TFNG",question:"Screen usage can disrupt sleep patterns?",answer:"true"},
  {passage:2,type:"MC",question:"Where was paper invented?",options:["China","Egypt","Greece"],answer:"China"},
  {passage:2,type:"SC",question:"Paper was invented over ___ years ago.",answer:"2000"}
];

function loadReading(){
  time=3600; startTimer();
  let html='';
  readingPassages.forEach((p,i)=>{html+=`<h3>${p.title}</h3><p>${p.text}</p>`;
    readingQuestions.filter(q=>q.passage===i).forEach((q,j)=>{
      if(q.type==='TFNG') html+=`<div class='question'><label>${j+1}. ${q.question}</label><br><select id='r${i}_${j}'><option value=''>Select</option><option value='true'>True</option><option value='false'>False</option><option value='ng'>Not Given</option></select></div>`;
      else if(q.type==='MC') html+=`<div class='question'><label>${j+1}. ${q.question}</label><br><select id='r${i}_${j}'><option value=''>Select</option>${q.options.map(o=>`<option value='${o}'>${o}</option>`).join('')}</select></div>`;
      else if(q.type==='SC') html+=`<div class='question'><label>${j+1}. ${q.question}</label><br><input type='text' id='r${i}_${j}'></div>`;
    });
  });
  document.getElementById('passageArea').innerHTML=html;
  document.getElementById('questionArea').innerHTML='<p>Select answers next to each question.</p>';
}

// ===== LISTENING SECTION =====
const listeningSections=[
  {audio:`The student plans to move in September. Rent: 150 pounds/week, utilities included, second floor, minimum six months.`,questions:[
    {q:"When does the student plan to move in?",id:"l1"},{q:"How much is the weekly rent?",id:"l2"},{q:"What is included in the rent?",id:"l3"} ]},
  {audio:`Riverside Sports Centre opened in April, open to public, free parking, gym equipment imported.`,questions:[
    {q:"When did the Sports Centre open?",id:"l4"},{q:"Who can use the centre?",id:"l5"},{q:"Where is the gym equipment from?",id:"l6"} ]},
  {audio:`Students discuss group project on urban transport. Presentation lasts 15 min, Sarah writes intro.`,questions:[
    {q:"What is the topic of the group project?",id:"l7"},{q:"Who writes the introduction?",id:"l8"} ]},
  {audio:`Lecture on sustainability, renewable energy: wind and solar, recycling reduces landfill, global cooperation required.`,questions:[
    {q:"Sustainability protects what?",id:"l9"},{q:"Which energy types are renewable?",id:"l10"} ]}
];

let currentListening=0; let played=[false,false,false,false];
function playListening(i){
  if(played[i]){alert('Section already played'); return;}
  let u=new SpeechSynthesisUtterance(listeningSections[i].audio); u.lang='en-GB'; u.rate=0.9;
  u.onend=()=>played[i]=true; speechSynthesis.speak(u);
}

function loadListening(){
  time=2400; startTimer();
  let html=`<h3>Listening Section ${currentListening+1}</h3>`;
  html+=`<button onclick='playListening(${currentListening})'>▶ Play Audio</button>`;
  listeningSections[currentListening].questions.forEach((q,j)=>{
    html+=`<div class='question'><label>${j+1}. ${q.q}</label><br><input type='text' id='${q.id}'></div>`;
  });
  document.getElementById('passageArea').innerHTML=html;
  document.getElementById('questionArea').innerHTML=`<button onclick='nextListening()'>Next Section</button>`;
}

function nextListening(){
  if(currentListening<listeningSections.length-1){ currentListening++; loadListening(); } else { alert('This is the last section'); }
}

// ===== SCORING & HISTORY =====
function band(score){if(score>=39)return 9;if(score>=37)return 8.5;if(score>=35)return 8;if(score>=32)return 7.5;if(score>=30)return 7;if(score>=26)return 6.5;if(score>=23)return 6;if(score>=18)return 5.5;if(score>=16)return 5;return 4.5;}
function saveResult(r,l){
  const history=JSON.parse(localStorage.getItem('ieltsHistory')||'[]');
  history.push({date:new Date().toLocaleString(),reading:r,listening:l});
  localStorage.setItem('ieltsHistory',JSON.stringify(history));
}
function showHistory(){
  const history=JSON.parse(localStorage.getItem('ieltsHistory')||'[]');
  if(history.length===0){alert('No results yet'); return;}
  alert(history.map(h=>`${h.date}\nReading: ${h.reading}/40 Listening: ${h.listening}/40`).join('\n\n'));
}
function submitTest(){
  let r=0,l=0;
  readingQuestions.forEach((q,i)=>{
    let val=document.getElementById(`r${q.passage}_${i}`)?.value.toLowerCase().trim(); if(val===q.answer.toLowerCase()) r++;
  });
  listeningSections.forEach(s=>s.questions.forEach(q=>{
    let val=document.getElementById(q.id)?.value.toLowerCase().trim(); if(val===listeningAnswers[parseInt(q.id.slice(1))-1].toLowerCase()) l++;
  }));
  saveResult(r,l);
  alert(`Reading: ${r}/40 Band ${band(r)}\nListening: ${l}/40 Band ${band(l)}`);
}

// Load default
loadReading();
</script></body>
</html>
