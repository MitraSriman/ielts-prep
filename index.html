<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>IELTS CBT Full Practice Test</title>
<style>
body{font-family:Arial,Helvetica,sans-serif;margin:0;background:#f5f7fa}
header{background:#0a3d62;color:#fff;padding:15px;text-align:center}
.container{display:flex;height:calc(100vh - 60px)}
.left{width:60%;padding:20px;overflow-y:auto;background:#ffffff}
.right{width:40%;padding:20px;overflow-y:auto;border-left:1px solid #ddd;background:#fafafa}
.question{margin-bottom:15px}
.timer{font-weight:bold;color:#c0392b}
button{padding:8px 12px;margin:5px 0}
input, select{width:90%;padding:5px;margin-top:5px}
.map-img{width:100%;margin:10px 0;border:1px solid #ccc;position:relative}
.map-label{position:absolute;background:rgba(255,255,255,0.9);padding:2px 5px;border:1px solid #333;border-radius:3px;cursor:pointer}
</style>
</head>
<body>
<header>
<h2>IELTS Academic – CBT Practice Test</h2>
<p class="timer" id="timer">Time: 60:00</p>
</header>

<div class="container">
<div class="left" id="passageArea"></div>
<div class="right" id="questionArea"></div>
</div>

<footer style="text-align:center;padding:10px">
<button onclick="loadReading()">Reading Test</button>
<button onclick="loadListening()">Listening Test</button>
<button onclick="submitTest()">Submit Test</button>
<button onclick="showHistory()">View Result History</button>
</footer>

<script>
// ===== TIMER =====
let time=3600; let timerInterval;
function startTimer(){
  clearInterval(timerInterval);
  timerInterval=setInterval(()=>{
    let m=Math.floor(time/60),s=time%60;
    document.getElementById('timer').innerText=`Time: ${m}:${s<10?'0':''}${s}`;
    if(time>0)time--;
  },1000);
}

// ===== READING =====
const readingPassages=[
{title:"Passage 1: Urban Farming Revolution", text:`Urban farming has become increasingly popular in cities worldwide. As urban populations grow, access to fresh produce has become a challenge. Rooftop gardens, vertical farms, and community plots provide local food while reducing transportation costs and carbon emissions. Researchers argue that urban farming also strengthens community ties and improves mental health. However, critics point out limitations such as space constraints, water supply issues, and high initial costs. Cities are exploring policy incentives and grants to support urban agriculture. The integration of technology such as hydroponics and smart watering systems is making it more viable.`},
{title:"Passage 2: Sleep and Cognitive Performance", text:`Sleep plays a critical role in memory formation, emotional regulation, and physical recovery. Studies show that adults require between seven and nine hours of sleep per night. Chronic sleep deprivation is linked to reduced concentration, weakened immunity, and increased risk of long-term illness. Despite this, modern lifestyles and excessive screen use disrupt natural sleep cycles. Napping, sleep hygiene practices, and mindfulness exercises are recommended to improve sleep quality. Research is ongoing to understand the impact of irregular work shifts on long-term cognitive performance.`},
{title:"Passage 3: History and Evolution of Paper", text:`Paper was invented in China over two thousand years ago and later spread to the Islamic world and Europe. The invention revolutionized record keeping, education, and art. Early paper was made from mulberry bark, hemp, and rags. Despite the rise of digital media, paper remains widely used due to its affordability, reliability, and accessibility in regions with limited technology. Innovations in papermaking over centuries improved quality and durability. Today, recycled paper and sustainable production are key focus areas for environmental conservation.`}
];

const readingQuestions=[
/* Passage 1 – 1–13 */
{passage:0,type:'TFNG',question:'Urban farming strengthens community ties.',answer:'true'},
{passage:0,type:'TFNG',question:'Rooftop gardens increase transportation costs.',answer:'false'},
{passage:0,type:'TFNG',question:'Urban farming improves mental health.',answer:'true'},
{passage:0,type:'SC',question:'Name one limitation of urban farming.',answer:'space constraints'},
{passage:0,type:'MC',question:'Which technology is used to improve urban farming?',options:['Hydroponics','Solar panels','3D printing'],answer:'Hydroponics'},
{passage:0,type:'TFNG',question:'High initial costs are a barrier.',answer:'true'},
{passage:0,type:'TFNG',question:'Community plots provide local food.',answer:'true'},
{passage:0,type:'MC',question:'Urban farming reduces what?',options:['Carbon emissions','Air pollution','Traffic congestion'],answer:'Carbon emissions'},
{passage:0,type:'SC',question:'Give one benefit of urban farming for mental health.',answer:'reduces stress'},
{passage:0,type:'TFNG',question:'Water supply is never an issue.',answer:'false'},
{passage:0,type:'MC',question:'Policy incentives aim to support?',options:['Urban agriculture','Digital media','Transportation'],answer:'Urban agriculture'},
{passage:0,type:'SC',question:'Name one urban farming method.',answer:'vertical farms'},
{passage:0,type:'TFNG',question:'Hydroponics is part of modern urban farming.',answer:'true'},
/* Passage 2 – 14–26 */
{passage:1,type:'SC',question:'Recommended hours of sleep for adults.',answer:'7–9'},
{passage:1,type:'TFNG',question:'Chronic sleep deprivation reduces concentration.',answer:'true'},
{passage:1,type:'TFNG',question:'Excessive screen use helps sleep.',answer:'false'},
{passage:1,type:'MC',question:'Sleep hygiene helps?',options:['Memory','Screen time','Both'],answer:'Memory'},
{passage:1,type:'TFNG',question:'Mindfulness exercises improve sleep quality.',answer:'true'},
{passage:1,type:'SC',question:'Negative effect of sleep deprivation on immunity.',answer:'weakened immunity'},
{passage:1,type:'MC',question:'Modern lifestyles disrupt?',options:['Natural sleep cycles','Exercise','Diet'],answer:'Natural sleep cycles'},
{passage:1,type:'SC',question:'One factor affecting long-term cognitive performance.',answer:'irregular work shifts'},
{passage:1,type:'TFNG',question:'Napping is beneficial.',answer:'true'},
{passage:1,type:'MC',question:'Sleep affects which process?',options:['Emotional regulation','Cooking','Transportation'],answer:'Emotional regulation'},
{passage:1,type:'SC',question:'Effect of insufficient sleep on concentration.',answer:'reduced concentration'},
{passage:1,type:'TFNG',question:'Mindfulness is recommended.',answer:'true'},
{passage:1,type:'SC',question:'Factor studied by researchers on performance.',answer:'long-term illness'},
/* Passage 3 – 27–40 */
{passage:2,type:'SC',question:'Where was paper invented?',answer:'China'},
{passage:2,type:'TFNG',question:'Paper spread to Europe.',answer:'true'},
{passage:2,type:'TFNG',question:'Early paper was made from digital media.',answer:'false'},
{passage:2,type:'SC',question:'One material used for early paper.',answer:'mulberry bark'},
{passage:2,type:'MC',question:'Paper remains used due to?',options:['Affordability','Luxury','Digital'],answer:'Affordability'},
{passage:2,type:'SC',question:'Name one environmental focus for paper today.',answer:'recycling'},
{passage:2,type:'SC',question:'Age of paper invention.',answer:'two thousand years'},
{passage:2,type:'TFNG',question:'Innovations improved quality.',answer:'true'},
{passage:2,type:'MC',question:'Paper accessibility is important in?',options:['Regions with limited technology','Cities only','Europe only'],answer:'Regions with limited technology'},
{passage:2,type:'SC',question:'One use of paper historically.',answer:'education'},
{passage:2,type:'TFNG',question:'Digital media has not replaced paper.',answer:'false'},
{passage:2,type:'SC',question:'Sustainable production focuses on?',answer:'environmental conservation'},
{passage:2,type:'MC',question:'Early paper invention country?',options:['China','Egypt','India'],answer:'China'},
{passage:2,type:'TFNG',question:'Paper remains widely used.',answer:'true'}
];

// ===== LISTENING =====
const listeningSections=[
{part:"Part 1", audio:"You are booking a room. Rent 150 pounds/week. Utilities included. Minimum stay 6 months.", mapImage:null,
 questions:[
 {id:"l1",q:"What is the weekly rent?",answer:"150"},
 {id:"l2",q:"Is utilities included?",answer:"yes"},
 {id:"l3",q:"Minimum stay in months?",answer:"6"},
 {id:"l4",q:"Preferred contact method?",answer:"email"},
 {id:"l5",q:"Floor of room?",answer:"second"},
 {id:"l6",q:"Deposit required?",answer:"yes"},
 {id:"l7",q:"Number of people sharing kitchen?",answer:"2"},
 {id:"l8",q:"Minutes to bus stop?",answer:"5"},
 {id:"l9",q:"Pets allowed?",answer:"no"},
 {id:"l10",q:"Move-in month?",answer:"september"}]},
{part:"Part 2", audio:"Welcome to the Riverside Sports Centre. Opened April. Free parking. Yoga classes weekdays.", mapImage:null,
 questions:[
 {id:"l11",q:"Month centre opened?",answer:"april"},
 {id:"l12",q:"Who can use swimming pool?",answer:"general public"},
 {id:"l13",q:"Free parking available to?",answer:"everyone"},
 {id:"l14",q:"Day yoga classes?",answer:"weekday"},
 {id:"l15",q:"Facilities available?",answer:"gym, pool"},
 {id:"l16",q:"Cafe serves what?",answer:"healthy"},
 {id:"l17",q:"Training included?",answer:"personal"},
 {id:"l18",q:"Closing time?",answer:"10"},
 {id:"l19",q:"Office handling complaints?",answer:"management"},
 {id:"l20",q:"Presentation hall?",answer:"lecture hall"}]},
{part:"Part 3", audio:"Students discussing library layout. Reading rooms left, computer stations right, group tables center, staff office back, lounge entrance.", 
 mapImage:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAQAAACEN3bzAAAADklEQVR4AWP4//8/AwAI/AL+Bkdn/wAAAABJRU5ErkJggg==",
 questions:[
 {id:"l21",q:"Where are the reading rooms located?",answer:"left"},
 {id:"l22",q:"Where are the computer stations?",answer:"right"},
 {id:"l23",q:"Where are the group tables?",answer:"center"},
 {id:"l24",q:"Where is the staff office?",answer:"back"},
 {id:"l25",q:"Where is the lounge?",answer:"entrance"},
 {id:"l26",q:"Number of group tables?",answer:"3"},
 {id:"l27",q:"Nearest room to entrance?",answer:"lounge"},
 {id:"l28",q:"Which room is at the back?",answer:"staff office"},
 {id:"l29",q:"Floor of library?",answer:"1"},
 {id:"l30",q:"Section opposite computer stations?",answer:"reading rooms"}]},
{part:"Part 4", audio:"Lecture about sustainability, renewable energy, and environmental responsibility.", mapImage:null,
 questions:[
 {id:"l31",q:"Which energies are renewable?",answer:"wind and solar"},
 {id:"l32",q:"Sustainability protects future what?",answer:"resources"},
 {id:"l33",q:"What type of farming causes deforestation?",answer:"intensive"},
 {id:"l34",q:"Urban areas produce which emissions?",answer:"carbon"},
 {id:"l35",q:"Recycling reduces which waste?",answer:"landfill"},
 {id:"l36",q:"Government incentives encourage what?",answer:"sustainability"},
 {id:"l37",q:"Behaviour change reduces what?",answer:"energy consumption"},
 {id:"l38",q:"Education raises what awareness?",answer:"environmental"},
 {id:"l39",q:"Lecture duration?",answer:"45"},
 {id:"l40",q:"Main challenge discussed?",answer:"climate change"}]}
];

let currentReading=0; let currentListening=0; let played=[false,false,false,false];

function loadReading(){
  time=3600; startTimer();
  let p=readingPassages[currentReading];
  let html=`<h3>${p.title}</h3><p>${p.text}</p>`;
  readingQuestions.filter(q=>q.passage===currentReading).forEach((q,j)=>{
    if(q.type==='TFNG') html+=`<div class='question'><label>${j+1}. ${q.question}</label><br><select id='r${currentReading}_${j}'><option value=''>Select</option><option value='true'>True</option><option value='false'>False</option><option value='ng'>Not Given</option></select></div>`;
    else if(q.type==='MC') html+=`<div class='question'><label>${j+1}. ${q.question}</label><br><select id='r${currentReading}_${j}'><option value=''>Select</option>${q.options.map(o=>`<option value='${o}'>${o}</option>`).join('')}</select></div>`;
    else if(q.type==='SC') html+=`<div class='question'><label>${j+1}. ${q.question}</label><br><input type='text' id='r${currentReading}_${j}'></div>`;
  });
  document.getElementById('passageArea').innerHTML=html;
  document.getElementById('questionArea').innerHTML=`<button onclick='prevReading()'>Previous Passage</button> <button onclick='nextReading()'>Next Passage</button>`;
}

function nextReading(){if(currentReading<readingPassages.length-1){currentReading++;loadReading();}}
function prevReading(){if(currentReading>0){currentReading--;loadReading();}}

function playListening(i){if(played[i]){alert('Already played');return;} let u=new SpeechSynthesisUtterance(listeningSections[i].audio);u.lang='en-GB';u.rate=0.9; u.onend=()=>played[i]=true; speechSynthesis.speak(u);}
function loadListening(){
  time=2400; startTimer();
  let s=listeningSections[currentListening];
  let html=`<h3>${s.part}</h3><button onclick='playListening(${currentListening})'>▶ Play Audio</button>`;
  if(s.mapImage) html+=`<div class='map-container'><img src='${s.mapImage}' class='map-img'></div>`;
  s.questions.forEach((q,j)=>{html+=`<div class='question'><label>${j+1}. ${q.q}</label><br><input type='text' id='${q.id}'></div>`;});
  document.getElementById('passageArea').innerHTML=html;
  document.getElementById('questionArea').innerHTML=`<button onclick='prevListening()'>Previous Section</button> <button onclick='nextListening()'>Next Section</button>`;
}
function nextListening(){if(currentListening<listeningSections.length-1){currentListening++; loadListening();}}
function prevListening(){if(currentListening>0){currentListening--; loadListening();}}

function band(score){if(score>=39)return 9;if(score>=37)return 8.5;if(score>=35)return 8;if(score>=32)return 7.5;if(score>=30)return 7;if(score>=26)return 6.5;if(score>=23)return 6;if(score>=18)return 5.5;if(score>=16)return 5;return 4.5;}

function submitTest(){
  let rscore=0; readingQuestions.forEach((q,i)=>{let val=document.getElementById(`r${q.passage}_${i}`)?.value.toLowerCase().trim(); if(val && val==q.answer.toLowerCase()) rscore++;});
  let lscore=0; listeningSections.forEach(s=>{s.questions.forEach(q=>{let val=document.getElementById(q.id)?.value.toLowerCase().trim(); if(val && val==q.answer.toLowerCase()) lscore++;});});
  saveResult(rscore,lscore);
  alert(`Reading: ${rscore}/40 | Listening: ${lscore}/40\nEstimated Band (Listening): ${band(lscore)}`);
}

function saveResult(r,l){
  const history=JSON.parse(localStorage.getItem('ieltsHistory')||'[]');
  history.push({date:new Date().toLocaleString(),reading:r,listening:l});
  localStorage.setItem('ieltsHistory',JSON.stringify(history));
}

function showHistory(){
  const history=JSON.parse(localStorage.getItem('ieltsHistory')||'[]');
  if(history.length===0){alert('No results yet'); return;}
  alert(history.map(h=>`${h.date}\nReading: ${h.reading}/40 Listening: ${h.listening}/40`).join('\n\n'));
}

// ===== DEFAULT LOAD =====
loadReading();
</script>
</body>
</html>
